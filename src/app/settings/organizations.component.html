<ng-container *ngIf="vault">
  <p *ngIf="!loaded" class="text-muted">
    <i class="bwi bwi-spinner bwi-spin" title="{{ 'loading' | i18n }}" aria-hidden="true"></i>
    <span class="sr-only">{{ "loading" | i18n }}</span>
  </p>
  <ng-container *ngIf="loaded">
    <ul class="bwi-ul card-ul carets" *ngIf="organizations && organizations.length">
      <li *ngFor="let o of organizations">
        <a [routerLink]="['/organizations', o.id]" class="text-body">
          <i class="bwi bwi-li bwi-caret-right" aria-hidden="true"></i> {{ o.name }}
          <ng-container *ngIf="!o.enabled">
            <i
              class="bwi bwi-exclamation-triangle text-danger"
              title="{{ 'organizationIsDisabled' | i18n }}"
              aria-hidden="true"
            ></i>
            <span class="sr-only">{{ "organizationIsDisabled" | i18n }}</span>
          </ng-container>
        </a>
      </li>
    </ul>
    <p *ngIf="!organizations || !organizations.length">{{ "noOrganizationsList" | i18n }}</p>
  </ng-container>
  <a href="#" routerLink="/settings/create-organization" class="btn btn-block btn-outline-primary">
    <i class="bwi bwi-plus bwi-fw" aria-hidden="true"></i>
    {{ "newOrganization" | i18n }}
  </a>
</ng-container>
<ng-container *ngIf="!vault">
  <div class="page-header d-flex">
    <h1>
      {{ "organizations" | i18n }}
      <small [appApiAction]="actionPromise" #action>
        <ng-container *ngIf="action.loading">
          <i
            class="bwi bwi-spinner bwi-spin text-muted"
            title="{{ 'loading' | i18n }}"
            aria-hidden="true"
          ></i>
          <span class="sr-only">{{ "loading" | i18n }}</span>
        </ng-container>
      </small>
    </h1>
    <a
      href="#"
      routerLink="/settings/create-organization"
      class="btn btn-sm btn-outline-primary ml-auto"
      *ngIf="!loaded || (organizations && organizations.length)"
    >
      <i class="bwi bwi-plus bwi-fw" aria-hidden="true"></i>
      {{ "newOrganization" | i18n }}
    </a>
  </div>
  <ng-container *ngIf="!loaded">
    <i
      class="bwi bwi-spinner bwi-spin text-muted"
      title="{{ 'loading' | i18n }}"
      aria-hidden="true"
    ></i>
    <span class="sr-only">{{ "loading" | i18n }}</span>
  </ng-container>
  <ng-container *ngIf="loaded">
    <ng-container *ngIf="!organizations || !organizations.length">
      <p>{{ "noOrganizationsList" | i18n }}</p>
      <a href="#" routerLink="/settings/create-organization" class="btn btn-outline-primary">
        <i class="bwi bwi-plus bwi-fw" aria-hidden="true"></i>
        {{ "newOrganization" | i18n }}
      </a>
    </ng-container>
    <table class="table table-hover table-list" *ngIf="organizations && organizations.length">
      <tbody>
        <tr *ngFor="let o of organizations; index as i">
          <td width="30">
            <app-avatar [data]="o.name" size="25" [circle]="true" [fontSize]="14"></app-avatar>
          </td>
          <td>
            <a href="#" [routerLink]="['/organizations', o.id]">{{ o.name }}</a>
            <ng-container *ngIf="!o.enabled">
              <i
                class="bwi bwi-exclamation-triangle text-danger"
                title="{{ 'organizationIsDisabled' | i18n }}"
                aria-hidden="true"
              ></i>
              <span class="sr-only">{{ "organizationIsDisabled" | i18n }}</span>
            </ng-container>
            <ng-container *ngIf="showEnrolledStatus(o)">
              <i
                class="bwi bwi-key"
                appStopProp
                title="{{ 'enrolledPasswordReset' | i18n }}"
                aria-hidden="true"
              ></i>
              <span class="sr-only">{{ "enrolledPasswordReset" | i18n }}</span>
            </ng-container>
          </td>
          <td class="table-list-options">
            <app-table-row-option-menu [rowIndex]="i">
              <app-table-row-option
                *ngIf="allowEnrollmentChanges(o) && !o.resetPasswordEnrolled"
                bwIcon="bwi-key"
                (onClick)="toggleResetPasswordEnrollment(o)"
              >
                {{ "enrollPasswordReset" | i18n }}
              </app-table-row-option>
              <app-table-row-option
                *ngIf="allowEnrollmentChanges(o) && o.resetPasswordEnrolled"
                bwIcon="bwi-undo"
                (onClick)="toggleResetPasswordEnrollment(o)"
              >
                {{ "withdrawPasswordReset" | i18n }}
              </app-table-row-option>
              <ng-container *ngIf="o.useSso && o.identifier">
                <app-table-row-option
                  *ngIf="o.ssoBound; else linkSso"
                  bwIcon="bwi-chain-broken"
                  (onClick)="unlinkSso(o)"
                >
                  {{ "unlinkSso" | i18n }}
                </app-table-row-option>
                <ng-template #linkSso>
                  <app-link-sso [organization]="o"> </app-link-sso>
                </ng-template>
              </ng-container>
              <app-table-row-option bwIcon="bwi-sign-out" class="text-danger" (onClick)="leave(o)">
                {{ "leave" | i18n }}
              </app-table-row-option>
            </app-table-row-option-menu>
          </td>
        </tr>
      </tbody>
    </table>
  </ng-container>
</ng-container>
